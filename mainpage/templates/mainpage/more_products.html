{% load humanize %}
{% load static %}
{% load persian_filters %}
{% load star_rating %}

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨ÛŒØ´ØªØ±</title>

    <link rel="stylesheet" href="{% static 'mainpage/style.css' %}?v=9">
    <link rel="stylesheet" href="{% static 'fontawesome/css/all.min.css' %}">
</head>
<body>
    <div class="container">
        <section class="products-box">
            <aside>
                <h3 class="filter-title">ÙÛŒÙ„ØªØ± Ù…Ø­ØµÙˆÙ„Ø§Øª</h3>
                <form method="get" class="filter-form">
                
                    <!-- ğŸ” Search -->
                    <input type="hidden" name="q" value="{{ request.GET.q }}">
                    <div class="filter-group">
                        <label>Ø¨Ø±Ù†Ø¯:</label>
                        <select name="brand">
                            <option value="">Ù‡Ù…Ù‡</option>
                            {% for brand in product_model.BRANDS %}
                            <option value="{{ brand }}" {% if brand_se == brand %}selected{% endif %}>{{ brand }}</option>
                            {% empty %}
                            {% endfor %}
                        </select>
                    </div>
              
                  <!-- âœ… Category -->
                  <div class="filter-group">
                    <label>Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ:</label>
                    <select name="category">
                      <option value="">Ù‡Ù…Ù‡</option>
                      {% for category in product_model.CATEGORY_CHOICES %}
                      <option value="{{ category.0 }}" {% if category_se == category.0 %}selected{% endif %}>{{ category.1 }}</option>
                      {% empty %}
                      {% endfor %}
                    </select>
                  </div>
              
                  <!-- âœ… Skin Type -->
                  <div class="filter-group">
                    <label>Ù†ÙˆØ¹ Ù¾ÙˆØ³Øª:</label>
                    <select name="skin_type">
                      <option value="">Ù‡Ù…Ù‡</option>
                      {% for skin_type in product_model.SKIN_TYPE_CHOICES %}
                      <option value="{{ skin_type.0 }}" {% if skin_type_se == skin_type.0 %}selected{% endif %}>{{ skin_type.1 }}</option>
                      {% empty %}
                      {% endfor %}
                    </select>
                  </div>
              
                  <!-- âœ… Concern -->
                  <div class="filter-group">
                    <label>Ù…Ø´Ú©Ù„ Ù¾ÙˆØ³ØªÛŒ:</label>
                    <input type="text" name="concern" value="{{ request.GET.concern }}" placeholder="Ù…Ø«Ù„Ø§ Ø¬ÙˆØ´">
                  </div>
              
                  <!-- âœ… Price -->
                  <div class="filter-group price-group">
                    <label>Ù‚ÛŒÙ…Øª:</label>
                    <input type="number" name="min_price" value="{{ request.GET.min_price }}" placeholder="Ø­Ø¯Ø§Ù‚Ù„">
                    <input type="number" name="max_price" value="{{ request.GET.max_price }}" placeholder="Ø­Ø¯Ø§Ú©Ø«Ø±">
                  </div>
              
                  <!-- âœ… Sorting -->
                  <div class="filter-group">
                    <label>Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ:</label>
                    <select name="sort_by">
                      <option value="">Ù¾ÛŒØ´â€ŒÙØ±Ø¶</option>
                      <option value="price_low" {% if request.GET.sort_by == 'price_low' %}selected{% endif %}>Ù‚ÛŒÙ…Øª Ú©Ù… Ø¨Ù‡ Ø²ÛŒØ§Ø¯</option>
                      <option value="price_high" {% if request.GET.sort_by == 'price_high' %}selected{% endif %}>Ù‚ÛŒÙ…Øª Ø²ÛŒØ§Ø¯ Ø¨Ù‡ Ú©Ù…</option>
                      <option value="rating" {% if request.GET.sort_by == 'rating' %}selected{% endif %}>Ø¨Ø§Ù„Ø§ØªØ±ÛŒÙ† Ø§Ù…ØªÛŒØ§Ø²</option>
                      <option value="popularity" {% if request.GET.sort_by == 'popularity' %}selected{% endif %}>Ù…Ø­Ø¨ÙˆØ¨ÛŒØª</option>
                    </select>
                  </div>
              
                  <button type="submit" class="page_button">Ø§Ø¹Ù…Ø§Ù„ ÙÛŒÙ„ØªØ±</button>
                </form>
            </aside>

            <div class="products">
                {% for product in products %}
                    <a href="{% url 'product_detail' product.pk %}" class="product_card">
                            <div class="product_image_div">
                                <img src="{{ product.image.url }}" alt="Ø¹Ù…Ø³ Ù…Ø­ØµÙˆÙ„" class="product_image">
                            </div>
                            <div class="product_info">
                                <p class="product_name">{{ product.name }}</p>
                                <p class="product_brand">Ø¨Ø±Ù†Ø¯ {{ product.brand }}</p>
                                <p class="product_price">{{ product.price|intcomma|persian_numbers }} ØªÙˆÙ…Ø§Ù†</p>
                                <div class="product_view-and-rate">
                                    <p class="view">{{ product.views|intcomma|persian_numbers }} Ø¨Ø§Ø²Ø¯ÛŒØ¯</p>
                                    <p class="rate">{{ product.rating|fa_star_rating|safe }}</p>
                                </div>
                            </div>
                    </a>
                {% empty %}
                    <p>Ù…Ø­ØµÙˆÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.</p>
                {% endfor %}
            </div>
        </section>
    </div>
</body>
</html>